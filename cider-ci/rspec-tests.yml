include:
  - path: cider-ci/context-components/env.yml
  - path: cider-ci/context-components/rails-setup.yml

generate_tasks:
  include_match: spec/.*_spec.rb

tasks: {}

task_defaults:
  include:
    - path: cider-ci/task-components/firefox.yml
  dispatch_storm_delay_duration: 1 seconds
  scripts:
    test:
      timeout: 15 Minutes
      body: |
        #!/usr/bin/env bash
        set -eux
        mkdir -p log
        unset PGPORT; unset PGUSER
        PGPORT=${PG10PORT} PGUSER=${PG10USER} \
          xvfb-run -a -e log/xvfb.log \
          ./bin/rspec $CIDER_CI_TASK_FILE
